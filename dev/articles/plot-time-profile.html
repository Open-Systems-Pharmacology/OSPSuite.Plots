<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time Profile Plots • ospsuite.plots</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time Profile Plots">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ospsuite.plots</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.9007</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Overview</h6></li>
    <li><a class="dropdown-item" href="../articles/ospsuite_plots.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plotting functions</h6></li>
    <li><a class="dropdown-item" href="../articles/plot-time-profile.html">Time Profile Plots</a></li>
    <li><a class="dropdown-item" href="../articles/box-whisker-vignette.html">Box-Whisker Plots</a></li>
    <li><a class="dropdown-item" href="../articles/histogram.html">Histogram Plots</a></li>
    <li><a class="dropdown-item" href="../articles/Goodness_of_fit.html">Goodness of fit</a></li>
    <li><a class="dropdown-item" href="../articles/Forestplots.html">Forestplots</a></li>
    <li><a class="dropdown-item" href="../articles/Range_Plot_Visualization.html">Range Plot Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Time Profile Plots</h1>
            
      

      <div class="d-none name"><code>plot-time-profile.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette documents and illustrates workflows for producing Time
Profile plots using the <code>ospsuite.plots</code> library.</p>
<p>Time profile plots are commonly used to compare observed and
simulated data over time. In these plots, observed data are typically
represented as scatter points with error bars indicating population
range or confidence intervals, while simulated data are displayed using
lines with shaded ribbons representing population range or confidence
intervals.</p>
<p>Basic documentation of the function can be found using:
<code><a href="../reference/plotTimeProfile.html">?plotTimeProfile</a></code>. The output of the function is a
<code>ggplot</code> object.</p>
<div class="section level3">
<h3 id="setup">1.1 Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>This vignette uses the <a href="https://www.open-systems-pharmacology.org/OSPSuite.Plots/">ospsuite.plots</a> and
<a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a> libraries. We will use the default settings of
<a href="https://www.open-systems-pharmacology.org/OSPSuite.Plots/">ospsuite.plots</a> (see vignette(“ospsuite.plots”, package =
“ospsuite.plots”)) but will adjust the legend position.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.open-systems-pharmacology.org/OSPSuite.Plots/">ospsuite.plots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set Defaults</span></span>
<span><span class="va">oldDefaults</span> <span class="op">&lt;-</span> <span class="fu">ospsuite.plots</span><span class="fu">::</span><span class="fu"><a href="../reference/setDefaults.html">setDefaults</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust legend position for better aesthetics</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_update</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_update</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_update</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_update</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">1.2 Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>This vignette uses randomly generated example datasets provided by
the package:</p>
<div class="section level4">
<h4 id="simulated-and-observed-data">1.2.1 Simulated and Observed Data<a class="anchor" aria-label="anchor" href="#simulated-and-observed-data"></a>
</h4>
<p>The following datasets are used in the example:</p>
<ul>
<li>
<code>simData1</code> and <code>obsData1</code>: ‘exponential
decay’</li>
<li>
<code>simData2</code> and <code>obsData2</code>: ‘first order
absorption with exponential decay’</li>
<li>
<code>simData</code> and <code>obsData</code>: combination of
<code>simData1</code> and <code>simData2</code> / <code>obsData1</code>
and <code>obsData2</code>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simData1</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"minValues"</span>, <span class="st">"maxValues"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simData2</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"minValues"</span>, <span class="st">"maxValues"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">simData1</span>, <span class="va">simData2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsData1</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"sd"</span>, <span class="st">"maxValues"</span>, <span class="st">"minValues"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsData2</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"sd"</span>, <span class="st">"maxValues"</span>, <span class="st">"minValues"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">obsData1</span>, <span class="va">obsData2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"First rows of example data simData"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>First rows of example data simData</caption>
<thead><tr class="header">
<th align="right">time</th>
<th align="right">values</th>
<th align="right">minValues</th>
<th align="right">maxValues</th>
<th align="left">caption</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">15.000</td>
<td align="right">12.000</td>
<td align="right">18.000</td>
<td align="left">Simulated Data 1</td>
</tr>
<tr class="even">
<td align="right">0.1</td>
<td align="right">14.851</td>
<td align="right">11.857</td>
<td align="right">17.857</td>
<td align="left">Simulated Data 1</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">14.703</td>
<td align="right">11.715</td>
<td align="right">17.714</td>
<td align="left">Simulated Data 1</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">14.557</td>
<td align="right">11.576</td>
<td align="right">17.573</td>
<td align="left">Simulated Data 1</td>
</tr>
<tr class="odd">
<td align="right">0.4</td>
<td align="right">14.412</td>
<td align="right">11.438</td>
<td align="right">17.433</td>
<td align="left">Simulated Data 1</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">14.268</td>
<td align="right">11.301</td>
<td align="right">17.294</td>
<td align="left">Simulated Data 1</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>simDataLloq</code> and <code>obsDataLloq</code>: dataset with
a column defining LLOQ.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simDataLloq</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DataSet3"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dimension</span> <span class="op">==</span> <span class="st">"concentration"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsDataLloq</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dimension</span> <span class="op">==</span> <span class="st">"concentration"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"caption"</span>, <span class="st">"lloq"</span>, <span class="st">"error_relative"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>simData2Dimension</code>: dataset where the “values” column
has mixed dimensions: “concentration” and “fraction”.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simData2Dimension</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"dimension"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsData2Dimension</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"dimension"</span>, <span class="st">"caption"</span>, <span class="st">"lloq"</span>, <span class="st">"error_relative"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>obsDataGender</code>: observed dataset with gender
information, and <code>simDataGender</code>: a mean model
presentation.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simDataGender</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet4"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"simulated"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"caption"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsDataGender</span> <span class="op">&lt;-</span> <span class="va">exampleDataTimeProfile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet4"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"values"</span>, <span class="st">"caption"</span>, <span class="st">"gender"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="metadata">1.2.2 MetaData<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h4>
<p>Metadata is a list that contains dimension and unit information for
dataset columns. If available, axis labels are set by this information.
If a time unit can be identified for the x-axis, breaks are set
according to this unit (see
<code><a href="../reference/updateScaleArgumentsForTimeUnit.html">?updateScaleArgumentsForTimeUnit</a></code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">exampleDataTimeProfile</span>, <span class="st">"metaData"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/metaData2DataFrame.html">metaData2DataFrame</a></span><span class="op">(</span><span class="va">metaData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"List of meta data"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>List of meta data</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">time</th>
<th align="left">values</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">Time</td>
<td align="left">Concentration</td>
</tr>
<tr class="even">
<td align="left">unit</td>
<td align="left">h</td>
<td align="left">mg/l</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples">2 Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following sections demonstrate <em>how to plot a Time
Profile</em> for specific scenarios.</p>
<div class="section level3">
<h3 id="plot-simulated-data-only">2.1 Plot Simulated Data Only<a class="anchor" aria-label="anchor" href="#plot-simulated-data-only"></a>
</h3>
<div class="section level4">
<h4 id="basic-example-with-multiple-simulations">2.1.1 Basic Example with Multiple Simulations<a class="anchor" aria-label="anchor" href="#basic-example-with-multiple-simulations"></a>
</h4>
<p>Datasets mapped to data are displayed as lines. The aesthetic
<code>groupby</code>, mapped in the example to the column caption,
groups profiles by the <code>caption</code> column. This means
<code>caption</code> is internally mapped to all aesthetics defined in
the variable <code>groupAesthetics</code>. By default, these are
<code>color</code>, <code>linetype</code>, <code>shape</code> (only
relevant for observed data), and <code>fill</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-single-mappingsimulation-plot-A-1.png" alt="Time profile plot showing multiple simulated concentration curves over time. Different simulation profiles are displayed as colored lines, with each line representing a different simulation scenario grouped by caption. The plot demonstrates basic time profile visualization for simulated data only." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="multiple-simulations-with-confidence-interval">2.1.2 Multiple Simulations with Confidence Interval<a class="anchor" aria-label="anchor" href="#multiple-simulations-with-confidence-interval"></a>
</h4>
<p>Mapping <code>ymin</code> and <code>ymax</code> will add a ribbon to
the time profile, indicating a prediction confidence interval or
population variance.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-single-mappingsimulation-plot-B-1.png" alt="Time profile plot showing simulated concentration curves with confidence intervals. Multiple simulation profiles are displayed as colored lines with shaded ribbon areas representing confidence intervals (ymin to ymax). This demonstrates how to visualize uncertainty or population variance in simulated time profile data." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="plot-observed-data-only">2.2 Plot Observed Data Only<a class="anchor" aria-label="anchor" href="#plot-observed-data-only"></a>
</h3>
<div class="section level4">
<h4 id="basic-example-with-multiple-observed-data-sets">2.2.1 Basic Example with Multiple Observed Data Sets<a class="anchor" aria-label="anchor" href="#basic-example-with-multiple-observed-data-sets"></a>
</h4>
<p>A dataset mapped to observed data is displayed as points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-single-observation-A-1.png" alt="Time profile plot showing observed data points over time. Multiple observed datasets are displayed as colored scatter points, with each dataset grouped by caption. The plot demonstrates basic time profile visualization for observed data without error bars or confidence intervals." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="observed-data-sets-with-confidence-interval">2.2.2 Observed Data Sets with Confidence Interval<a class="anchor" aria-label="anchor" href="#observed-data-sets-with-confidence-interval"></a>
</h4>
<p>Mapping <code>ymin</code> and <code>ymax</code> adds error bars.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-single-observation-B-1.png" alt="Time profile plot showing observed data points with confidence intervals. Multiple observed datasets are displayed as colored scatter points with vertical error bars representing confidence intervals (ymin to ymax). This demonstrates how to visualize measurement uncertainty in observed time profile data." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="usage-of-aesthetic-error">2.2.3 Usage of Aesthetic “Error”<a class="anchor" aria-label="anchor" href="#usage-of-aesthetic-error"></a>
</h4>
<p>The dataset includes a column with the standard deviation
<code>sd</code>. If mapped to ‘error’, this variable will be used to
create corresponding <code>ymin</code> and <code>ymax</code> values for
the error bars <code>ymin = values - sd</code> and
<code>ymax = values + sd</code>. If <code>yscale = 'log'</code>,
<code>ymin</code> values below 0 are set to <code>y</code>.
Additionally, <code>error_relative</code> can be used where a
multiplicative error is assumed:
<code>ymin = values / error_relative</code> and
<code>ymax = values * error_relative</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    error <span class="op">=</span> <span class="va">sd</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-single-observation-C-1.png" alt="Time profile plot showing observed data points with error bars calculated from standard deviation. The plot displays colored scatter points with vertical error bars where ymin = values - sd and ymax = values + sd, demonstrating the use of the 'error' aesthetic for automatic error bar calculation." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="observed-data-with-lloq">2.2.4 Observed Data with LLOQ<a class="anchor" aria-label="anchor" href="#observed-data-with-lloq"></a>
</h4>
<p>If <code>lloq</code> is mapped to a column indicating the lower limit
of quantification, a horizontal line for the <code>lloq</code> values is
displayed, and all values below <code>lloq</code> are plotted with
decreased alpha. As the comparison is done by row, multiple
<code>lloq</code> values are possible.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  observedData <span class="op">=</span> <span class="va">obsDataLloq</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    error_relative <span class="op">=</span> <span class="va">error_relative</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Duplicated aesthetics after name standardisation:</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">groupby</span></span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/example-lloq-1.png" alt="Time profile plot showing observed data with lower limit of quantification (LLOQ) handling. The plot displays scatter points with a horizontal LLOQ line, where data points below the LLOQ threshold are shown with reduced transparency and relative error bars are included." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="omit-data-points-flagged-as-missing-dependent-variable-mdv">2.2.5 Omit Data Points Flagged as Missing Dependent Variable
(MDV)<a class="anchor" aria-label="anchor" href="#omit-data-points-flagged-as-missing-dependent-variable-mdv"></a>
</h4>
<p>The following code adds a new column where all values higher than 10
are flagged as <code>mdv</code>. This leads to a plot without any
observed data points higher than 10 (removing the first
observation).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdvData</span> <span class="op">&lt;-</span> <span class="va">obsData</span></span>
<span><span class="va">mdvData</span><span class="op">$</span><span class="va">mdv</span> <span class="op">&lt;-</span> <span class="va">mdvData</span><span class="op">$</span><span class="va">values</span> <span class="op">&gt;</span> <span class="fl">10</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  observedData <span class="op">=</span> <span class="va">mdvData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-mdv-1.png" alt="Time profile plot demonstrating missing dependent variable (MDV) exclusion. Observed data points are plotted with confidence intervals, but data points with values greater than 10 are excluded from the visualization, showing how the MDV flag can be used to filter out specific data points." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="plot-simulated-and-observed-data">2.3 Plot Simulated and Observed Data<a class="anchor" aria-label="anchor" href="#plot-simulated-and-observed-data"></a>
</h3>
<p>By plotting simulated and observed data together, you can often find
pairs of corresponding datasets. This can be done using a common legend
entry (see section 2.3.1) or by defining a mapping table, where each
observed dataset is mapped to one simulated dataset (see section 2.3.2).
There may also be examples with independent datasets (see section
2.3.3).</p>
<div class="section level4">
<h4 id="corresponding-simulated-and-observed-datasets-with-common-legend-entry">2.3.1 Corresponding Simulated and Observed Datasets with Common
Legend Entry<a class="anchor" aria-label="anchor" href="#corresponding-simulated-and-observed-datasets-with-common-legend-entry"></a>
</h4>
<p>In this example, we create a new column with a common caption for
simulated and observed data. This column is then mapped to the aesthetic
<code>groupby</code>, leading to a single common legend for both
observed and simulated data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create datasets with common caption</span></span>
<span><span class="va">simData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">simData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>captionCommon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Simulated "</span>, <span class="st">""</span>, <span class="va">caption</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">obsData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>captionCommon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Observed "</span>, <span class="st">""</span>, <span class="va">caption</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">captionCommon</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/combine-simulated-and-observed-sharing-legend-1.png" alt="Time profile plot combining simulated and observed data with shared legend entries. Simulated data appear as colored lines with ribbon confidence intervals, while observed data appear as matching colored points with error bars. Both datasets share common legend entries by having matching caption names." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="corresponding-simulated-and-observed-datasets-with-separate-legend-entries-and-mapping-table">2.3.2 Corresponding Simulated and Observed Datasets with Separate
Legend Entries and Mapping Table<a class="anchor" aria-label="anchor" href="#corresponding-simulated-and-observed-datasets-with-separate-legend-entries-and-mapping-table"></a>
</h4>
<p>In this example, we create a mapping table with one column for
<code>observed</code> and one column for <code>simulated</code>. This
table is passed to the function as the input variable
<code>mapSimulatedAndObserved</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapSimulatedAndObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obsData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mapSimulatedAndObserved</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">simulated</th>
<th align="left">observed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Simulated Data 1</td>
<td align="left">Observed Data 1</td>
</tr>
<tr class="even">
<td align="left">Simulated Data 2</td>
<td align="left">Observed Data 2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mapSimulatedAndObserved <span class="op">=</span> <span class="va">mapSimulatedAndObserved</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/combine-simulated-and-observed-separate-legend-1.png" alt="Time profile plot combining simulated and observed data with separate legend entries using mapping table. Simulated data appear as colored lines with ribbons, observed data as points with error bars. The mapping table pairs specific simulated datasets with corresponding observed datasets, creating separate legend entries for each." width="80%" style="display: block; margin: auto;"></p>
<p>If not all simulated datasets have corresponding observed datasets
(or vice versa), it is possible to fill the mapping table with empty
strings for the missing datasets. The empty strings should be at the end
of the table.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapSimulatedAndObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obsData1</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mapSimulatedAndObserved</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">simulated</th>
<th align="left">observed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Simulated Data 1</td>
<td align="left">Observed Data 1</td>
</tr>
<tr class="even">
<td align="left">Simulated Data 2</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData1</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mapSimulatedAndObserved <span class="op">=</span> <span class="va">mapSimulatedAndObserved</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/combine-simulated-and-observed-separate-legend-2-1.png" alt="Time profile plot demonstrating partial mapping between simulated and observed datasets. Shows how to handle cases where not all simulated datasets have corresponding observed datasets, using empty strings in the mapping table for missing pairings." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="independent-simulated-and-observed-datasets">2.3.3 Independent Simulated and Observed Datasets<a class="anchor" aria-label="anchor" href="#independent-simulated-and-observed-datasets"></a>
</h4>
<p>The example below shows individual observed data compared to one
simulation. Here, a mapping between observed and simulated data doesn’t
make sense. The <code>groupby</code> aesthetic is used to group the
observed data by color, fill, and shape. To avoid an extra color for the
simulated line, the line color is set by <code>geomLineAttributes</code>
as an attribute and not as an aesthetic. The simulated line inherits the
<code>linetype</code> aesthetic from the <code>groupby</code> aesthetic,
adding a <code>linetype</code> legend for the simulated data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simDataGender</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsDataGender</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  geomLineAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="st">"Observed Data"</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"Observed Data"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Observed Data"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Simulation"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Ignoring unknown labels:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #00BB00;">linetype</span> : <span style="color: #0000BB;">"Simulation"</span></span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/combine-multiple-simulated-and-observed-1.png" alt="Time profile plot combining multiple simulated and observed datasets with customized legend formatting. Shows simulated data as black lines and observed data as colored points, with separate legends for simulation and observed data components, and custom legend positioning and titles." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="multiple-simulations-and-observed-data-sets-without-legends">2.3.4 Multiple Simulations and Observed Data Sets without
Legends<a class="anchor" aria-label="anchor" href="#multiple-simulations-and-observed-data-sets-without-legends"></a>
</h4>
<p>To map <code>groupby</code> with an empty variable
<code>groupAesthetics</code> leads to a plot without legends.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  groupAesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/examples-multiple-simulations-no-caption-1.png" alt="Time profile plot showing multiple simulations and observed data without legend. By setting groupAesthetics to empty, both simulated and observed data are displayed without color grouping or legend entries, creating a simplified visualization focusing on the data patterns." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="observed-data-with-shape-as-gender">2.3.5 Observed Data with Shape as Gender<a class="anchor" aria-label="anchor" href="#observed-data-with-shape-as-gender"></a>
</h4>
<p>In this example, observed data is used as both simulated and observed
data, connecting the different data points with a thin line.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">obsDataGender</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsDataGender</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    shape <span class="op">=</span> <span class="va">gender</span></span>
<span>  <span class="op">)</span>,</span>
<span>  geomLineAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"solid"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/observedData-used-as-simulatedData-plot-1.png" alt="Time profile plot using observed data as both simulated and observed data layers. Shows how observed data points can be connected with thin lines and differentiated by shapes representing gender, creating a hybrid visualization with both line connections and scatter points." width="80%" style="display: block; margin: auto;"></p>
<p>A similar plot can be produced by combining <code>caption</code> and
<code>gender</code> with interaction.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">obsDataGender</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsDataGender</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">caption</span>, <span class="va">gender</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  geomLineAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"solid"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/observedData-used-as-simulatedData-plot-B-1.png" alt="Time profile plot using interaction of caption and gender for grouping. Similar to previous plot but combines caption and gender into single interaction groups, creating distinct line and point combinations for each unique caption-gender combination with unified legend entries." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="data-with-secondary-axis">2.3.6 Data with Secondary Axis<a class="anchor" aria-label="anchor" href="#data-with-secondary-axis"></a>
</h4>
<p>In this example, a plot is generated with concentration on the left
y-axis and fraction on the right y-axis. First, the
<code>metaData</code> variable has to be adjusted. For the primary
y-axis, the column “values” is mapped, and <code>metaData</code>
provides the dimension “Concentration” for this column. A new entry “y2”
is added for the secondary y-axis.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaDataY2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dimension <span class="op">=</span> <span class="st">"Time"</span>, unit <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span>,</span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dimension <span class="op">=</span> <span class="st">"Concentration"</span>, unit <span class="op">=</span> <span class="st">"mg/l"</span><span class="op">)</span>,</span>
<span>  y2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dimension <span class="op">=</span> <span class="st">"Fraction"</span>, unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The mapping <code>y2axis</code> must be logical. In this example, it
is <code>(dimension == "fraction")</code>. For the primary y-axis
(concentration), a log scale is displayed, and for the secondary
(fraction), a linear scale is used. The limits of the secondary axis are
set to [0, 1].</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData2Dimension</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData2Dimension</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    error_relative <span class="op">=</span> <span class="va">error_relative</span>,</span>
<span>    lloq <span class="op">=</span> <span class="va">lloq</span>,</span>
<span>    y2axis <span class="op">=</span> <span class="op">(</span><span class="va">dimension</span> <span class="op">==</span> <span class="st">"fraction"</span><span class="op">)</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">dimension</span>,</span>
<span>    shape <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaDataY2</span>,</span>
<span>  yscale <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>  yscale.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y2scale <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  y2scale.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.box <span class="op">=</span> <span class="st">"vertical"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/secondaryAxis_plot-1.png" alt="Time profile plot with dual y-axes showing concentration and fraction data. The left y-axis displays concentration values on log scale, while the right y-axis shows fraction values on linear scale. Data includes both simulated lines and observed points with error bars and LLOQ handling." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plot-configuration">3. Plot Configuration<a class="anchor" aria-label="anchor" href="#plot-configuration"></a>
</h2>
<div class="section level3">
<h3 id="example-for-changing-geom-attributes">3.1 Example for Changing Geom Attributes<a class="anchor" aria-label="anchor" href="#example-for-changing-geom-attributes"></a>
</h3>
<p>The plot from section 2.3.2 was adjusted using geom attributes:</p>
<ul>
<li>
<code>geomLineAttributes = list(linetype = 'solid')</code>: The
lines used for the simulated data are set to solid in both datasets.
Note that the line type for the error bars and ribbon edges remains
unchanged.</li>
<li>
<code>geomErrorbarAttributes = list()</code>: The default settings
for <code>geomErrorbarAttributes</code>, width = 0, were removed so that
the bar caps are now visible.</li>
<li>
<code>geomRibbonAttributes = list(alpha = 0.1)</code>: The shade of
the ribbons was decreased by setting the alpha to 0.1; the default value
for color = NA was omitted, making the edges visible.</li>
<li>
<code>geomPointAttributes = list(size = 7)</code>: The size of the
symbols was increased.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapSimulatedAndObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obsData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  geomLineAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span>,</span>
<span>  geomErrorbarAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  geomRibbonAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  geomPointAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>  mapSimulatedAndObserved <span class="op">=</span> <span class="va">mapSimulatedAndObserved</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/changing_geom_attributes-1.png" alt="Time profile plot demonstrating customized geometric attributes. Shows modified line types (solid), larger error bar width, reduced ribbon transparency (alpha=0.1), and increased point size (size=7), illustrating how to customize the visual appearance of plot elements." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-for-changing-color-scales">3.2 Example for Changing Color Scales<a class="anchor" aria-label="anchor" href="#example-for-changing-color-scales"></a>
</h3>
<div class="section level4">
<h4 id="without-mapping-table">3.2.1 Without Mapping Table<a class="anchor" aria-label="anchor" href="#without-mapping-table"></a>
</h4>
<p>For plots showing only simulated or observed data, or plots with a
common legend (see section 2.3.1), the colors are changed using
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> functions like
<code>scale_color_manual</code>.</p>
<p>Below, the plot from section 2.3.1 is repeated.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create datasets with common caption</span></span>
<span><span class="va">simData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">simData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>captionCommon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Simulated "</span>, <span class="st">""</span>, <span class="va">caption</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obsData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">obsData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>captionCommon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Observed "</span>, <span class="st">""</span>, <span class="va">caption</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">captionCommon</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Data 1"</span> <span class="op">=</span> <span class="st">"darkred"</span>, <span class="st">"Data 2"</span> <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Data 1"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"Data 2"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/colorscaling-1.png" alt="Time profile plot demonstrating custom color scaling with manual color assignment. Shows simulated lines with ribbons and observed points using custom color palettes (darkred/red for Data 1, darkgreen/green for Data 2) applied via scale_color_manual and scale_fill_manual functions." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="with-mapping-table">3.2.2 With Mapping Table<a class="anchor" aria-label="anchor" href="#with-mapping-table"></a>
</h4>
<p>It is possible to add columns with aesthetics to the table used to
map simulated and observed data. The column headers must correspond to
one of the aesthetics defined in <code>groupAesthetics</code>.</p>
<p>In the example below, this is done for ‘color’ and ‘fill’:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define Data Mappings</span></span>
<span><span class="va">mapSimulatedAndObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obsData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mapSimulatedAndObserved</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">simulated</th>
<th align="left">observed</th>
<th align="left">color</th>
<th align="left">fill</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Simulated Data 1</td>
<td align="left">Observed Data 1</td>
<td align="left">darkred</td>
<td align="left">red</td>
</tr>
<tr class="even">
<td align="left">Simulated Data 2</td>
<td align="left">Observed Data 2</td>
<td align="left">darkgreen</td>
<td align="left">green</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mapSimulatedAndObserved <span class="op">=</span> <span class="va">mapSimulatedAndObserved</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/colorscaling-with-mappingtable-1.png" alt="Time profile plot demonstrating custom color scaling using a mapping table for aesthetics. The plot combines simulated and observed data, with simulated data represented as colored lines and ribbons, and observed data as points with corresponding colors. Custom colors are assigned to each dataset via the mapping table, enhancing the visual differentiation between the datasets." width="80%" style="display: block; margin: auto;"></p>
<p>Changing the scales when using the observed simulation mapping table
can also be done by adding scales manually, but it is a bit more
complicated. If <code>mapSimulatedAndObserved</code> is not null, a
reset of all relevant scales is done before plotting the observed data.
The scales for the simulated data must be set before this reset. You
have to call <code>plotTimeProfile</code> two times:</p>
<ol style="list-style-type: decimal">
<li>Call <code><a href="../reference/plotTimeProfile.html">plotTimeProfile()</a></code> for simulated data only.</li>
<li>Set scales for simulated data.</li>
<li>Call <code><a href="../reference/plotTimeProfile.html">plotTimeProfile()</a></code> for observed data only with the
simulated plot as input <code>plotObject</code>.</li>
<li>Set scales for observed data.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapSimulatedAndObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obsData</span><span class="op">$</span><span class="va">caption</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Data Mappings</span></span>
<span><span class="va">mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">time</span>,</span>
<span>  y <span class="op">=</span> <span class="va">values</span>,</span>
<span>  ymin <span class="op">=</span> <span class="va">minValues</span>,</span>
<span>  ymax <span class="op">=</span> <span class="va">maxValues</span>,</span>
<span>  groupby <span class="op">=</span> <span class="va">caption</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="va">mapping</span>,</span>
<span>  mapSimulatedAndObserved <span class="op">=</span> <span class="va">mapSimulatedAndObserved</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Simulated Data 1"</span> <span class="op">=</span> <span class="st">"darkred"</span>, <span class="st">"Simulated Data 2"</span> <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Simulated Data 1"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"Simulated Data 2"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  plotObject <span class="op">=</span> <span class="va">plotObject</span>,</span>
<span>  observedData <span class="op">=</span> <span class="va">obsData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="va">mapping</span>,</span>
<span>  mapSimulatedAndObserved <span class="op">=</span> <span class="va">mapSimulatedAndObserved</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Observed Data 1"</span> <span class="op">=</span> <span class="st">"darkred"</span>, <span class="st">"Observed Data 2"</span> <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">y</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plotObject</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/example_changing_colorscales-1.png" alt="Time profile plot demonstrating custom color scaling with manual color assignment. Shows simulated lines with ribbons and observed points using custom color palettes (darkred/red for Data 1, darkgreen/green for Data 2) applied via scale_color_manual and scale_fill_manual functions." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="example-for-adjusting-x-and-y-scale">3.3 Example for Adjusting X and Y Scale<a class="anchor" aria-label="anchor" href="#example-for-adjusting-x-and-y-scale"></a>
</h3>
<p>In the example, we set the scale for the y-axis to log scale. By
default, a time profile plot starts at 0; here, the defaults were
overwritten, and the breaks were set manually.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">values</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span> <span class="op">+</span> <span class="fl">24</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span>,</span>
<span>  yscale <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>  xscale.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">48</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">48</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/example_adjusting_xy_scale-1.png" alt="Time profile plot showing adjusted y-axis scale to log scale, with customized x-axis limits and breaks. The plot visualizes simulated data filtered to values greater than zero, illustrating how to manipulate axis scales effectively." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="adjust-time-unit">3.4 Adjust Time Unit<a class="anchor" aria-label="anchor" href="#adjust-time-unit"></a>
</h3>
<p>The breaks of the time axis are set according to the units provided
by the variable <code>metaData</code>.</p>
<p>Below, we show the same plot with four different time units:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">unit</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"day(s)"</span>, <span class="st">"weeks(s)"</span>, <span class="st">"month(s)"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">metaData</span><span class="op">$</span><span class="va">time</span><span class="op">$</span><span class="va">unit</span> <span class="op">&lt;-</span> <span class="va">unit</span></span>
<span>  <span class="va">plotlist</span><span class="op">[[</span><span class="va">unit</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotTimeProfile.html">plotTimeProfile</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">simData</span>,</span>
<span>    metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time</span>,</span>
<span>      y <span class="op">=</span> <span class="va">values</span>,</span>
<span>      groupby <span class="op">=</span> <span class="va">caption</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time unit:"</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plotlist</span>, labels <span class="op">=</span> <span class="st">"AUTO"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot-time-profile_files/figure-html/example_timeUnit-1.png" alt="Grid of time profile plots demonstrating the effect of different time units on the x-axis. Each plot is labeled according to the time unit used, illustrating how time unit adjustments can influence the visualization of time profile data." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/KatrinCoboeken" class="external-link">Katrin Coboeken</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
