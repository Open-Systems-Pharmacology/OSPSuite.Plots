<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Goodness of fit • ospsuite.plots</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Goodness of fit">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ospsuite.plots</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.1.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ospsuite-plots.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Overview</h6></li>
    <li><a class="dropdown-item" href="../articles/ospsuite-plots.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plotting functions</h6></li>
    <li><a class="dropdown-item" href="../articles/plot-time-profile.html">Time Profile Plots</a></li>
    <li><a class="dropdown-item" href="../articles/box-whisker-plots.html">Box-Whisker Plots</a></li>
    <li><a class="dropdown-item" href="../articles/histogram.html">Histogram Plots</a></li>
    <li><a class="dropdown-item" href="../articles/goodness-of-fit.html">Goodness of fit</a></li>
    <li><a class="dropdown-item" href="../articles/forest-plots.html">Forestplots</a></li>
    <li><a class="dropdown-item" href="../articles/range-plot-visualization.html">Range Plot Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Goodness of fit</h1>
            
      

      <div class="d-none name"><code>goodness-of-fit.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>ospsuite.plots</code> library provides functions to compare
predicted and observed data and resulting residuals:</p>
<ul>
<li>
<code><a href="../reference/plotPredVsObs.html">plotPredVsObs()</a></code> (see section 2): plot predicted values
versus corresponding observed values.</li>
<li>
<code><a href="../reference/plotResVsCov.html">plotResVsCov()</a></code> (see section 3): plot residuals as
points versus a covariate (e.g., Time, observed values, or Age).</li>
<li>
<code><a href="../reference/plotRatioVsCov.html">plotRatioVsCov()</a></code> (see section 4): plot ratios as points
versus a covariate (e.g., Time, observed values, or Age).</li>
<li>
<code><a href="../reference/plotQQ.html">plotQQ()</a></code> (see section 5): Quantile-Quantile plot.</li>
</ul>
<p>In these functions, the aesthetics <code>observed</code> and
<code>predicted</code> can be used. These aesthetics are also available
in other functions of the <code>ospsuite.plots</code> library:</p>
<ul>
<li>
<code>plotBoxwhisker()</code> (see section 6.1): aggregate residuals
and display aggregated values versus covariate.</li>
<li>
<code><a href="../reference/plotHistogram.html">plotHistogram()</a></code> (see section 6.2): generates histograms
of residuals.</li>
</ul>
<p>The functions <code><a href="../reference/plotPredVsObs.html">plotPredVsObs()</a></code>,
<code><a href="../reference/plotResVsCov.html">plotResVsCov()</a></code>, and <code><a href="../reference/plotRatioVsCov.html">plotRatioVsCov()</a></code> are
mainly wrappers around the function <code>plotXVsY()</code>, using
different defaults for input variables. So, use <code>?plotXvsY</code>
to get more details.</p>
<p>For DDI comparison, the functions <code><a href="../reference/plotPredVsObs.html">plotPredVsObs()</a></code> and
<code>plotResVsObs()</code> can be overlaid with lines indicating the
limits of the Guest Criteria (<a href="https://dmd.aspetjournals.org/content/39/2/170" class="external-link uri">https://dmd.aspetjournals.org/content/39/2/170</a>) (see
section 7).</p>
<div class="section level3">
<h3 id="setup">1.1 Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>This vignette uses the <a href="https://www.open-systems-pharmacology.org/OSPSuite.Plots/">ospsuite.plots</a> and
<a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a> libraries. We will use the default settings of
<a href="https://www.open-systems-pharmacology.org/OSPSuite.Plots/">ospsuite.plots</a> (see vignette(“ospsuite.plots”, package =
“ospsuite.plots”)).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>rmarkdown.html_vignette.check_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set watermark option required for ospsuite.plots functionality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>ospsuite.plots.watermark_enabled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.open-systems-pharmacology.org/OSPSuite.Plots/">ospsuite.plots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">oldDefaults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setDefaults.html">setDefaults</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">1.2 Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>This vignette uses two randomly generated example datasets provided
by the package.</p>
<div class="section level4">
<h4 id="dataset-with-predicted-and-observed-data">1.2.1 Dataset with Predicted and Observed Data<a class="anchor" aria-label="anchor" href="#dataset-with-predicted-and-observed-data"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">exampleDataCovariates</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet2"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Age"</span>, <span class="st">"Obs"</span>, <span class="st">"gsd"</span>, <span class="st">"Pred"</span>, <span class="st">"Sex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"First rows of example data."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>First rows of example data.</caption>
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">Age</th>
<th align="right">Obs</th>
<th align="right">gsd</th>
<th align="right">Pred</th>
<th align="left">Sex</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">44</td>
<td align="right">28.808</td>
<td align="right">1.009</td>
<td align="right">32.535</td>
<td align="left">Female</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">23</td>
<td align="right">77.476</td>
<td align="right">0.992</td>
<td align="right">76.418</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">26</td>
<td align="right">35.861</td>
<td align="right">1.028</td>
<td align="right">34.282</td>
<td align="left">Female</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">20</td>
<td align="right">62.711</td>
<td align="right">1.072</td>
<td align="right">55.015</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">21</td>
<td align="right">30.475</td>
<td align="right">1.045</td>
<td align="right">29.751</td>
<td align="left">Female</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">48</td>
<td align="right">74.238</td>
<td align="right">0.989</td>
<td align="right">67.357</td>
<td align="left">Male</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">metaData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">exampleDataCovariates</span>, <span class="st">"metaData"</span><span class="op">)</span></span>
<span><span class="va">metaData</span> <span class="op">&lt;-</span> <span class="va">metaData</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">metaData</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/metaData2DataFrame.html">metaData2DataFrame</a></span><span class="op">(</span><span class="va">metaData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"List of meta data"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>List of meta data</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Age</th>
<th align="left">Obs</th>
<th align="left">Pred</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">Age</td>
<td align="left">Clearance</td>
<td align="left">Clearance</td>
</tr>
<tr class="even">
<td align="left">unit</td>
<td align="left">yrs</td>
<td align="left">dL/h/kg</td>
<td align="left">dL/h/kg</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="dataset-for-examples-with-ddi-prediction">1.2.2 Dataset for Examples with DDI Prediction<a class="anchor" aria-label="anchor" href="#dataset-for-examples-with-ddi-prediction"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dDIdata</span> <span class="op">&lt;-</span> <span class="va">exampleDataCovariates</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet3"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Obs"</span>, <span class="st">"Pred"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Study"</span>, <span class="va">ID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dDIdata</span><span class="op">$</span><span class="va">Study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dDIdata</span><span class="op">$</span><span class="va">Study</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dDIdata</span><span class="op">$</span><span class="va">Study</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dDIdata</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"First rows of dataset used for DDI example."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>First rows of dataset used for DDI example.</caption>
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">Obs</th>
<th align="right">Pred</th>
<th align="left">Study</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.53</td>
<td align="right">0.83</td>
<td align="left">Study 1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.20</td>
<td align="right">0.90</td>
<td align="left">Study 2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.43</td>
<td align="right">0.50</td>
<td align="left">Study 3</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4.93</td>
<td align="right">3.39</td>
<td align="left">Study 4</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1.39</td>
<td align="right">1.10</td>
<td align="left">Study 5</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.44</td>
<td align="right">0.39</td>
<td align="left">Study 6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dDImetaData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  Obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dimension <span class="op">=</span> <span class="st">"DDI AUC Ratio"</span>, unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  Pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dimension <span class="op">=</span> <span class="st">"DDI AUC Ratio"</span>, unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/metaData2DataFrame.html">metaData2DataFrame</a></span><span class="op">(</span><span class="va">dDImetaData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"List of meta data"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>List of meta data</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Obs</th>
<th align="left">Pred</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">DDI AUC Ratio</td>
<td align="left">DDI AUC Ratio</td>
</tr>
<tr class="even">
<td align="left">unit</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="dataset-for-ratio-comparison">1.2.3 Dataset for Ratio Comparison<a class="anchor" aria-label="anchor" href="#dataset-for-ratio-comparison"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkRatioData</span> <span class="op">&lt;-</span> <span class="va">exampleDataCovariates</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SetID</span> <span class="op">==</span> <span class="st">"DataSet1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SetID"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gsd <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pkRatiometaData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">exampleDataCovariates</span>, <span class="st">"metaData"</span><span class="op">)</span></span>
<span><span class="va">pkRatiometaData</span> <span class="op">&lt;-</span> <span class="va">pkRatiometaData</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pkRatioData</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pkRatiometaData</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pkRatioData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">Age</th>
<th align="right">Obs</th>
<th align="right">Pred</th>
<th align="right">Ratio</th>
<th align="left">AgeBin</th>
<th align="left">Sex</th>
<th align="left">Country</th>
<th align="right">SD</th>
<th align="right">gsd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">48</td>
<td align="right">4.00</td>
<td align="right">2.90</td>
<td align="right">0.725</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.693</td>
<td align="right">1.1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">36</td>
<td align="right">4.40</td>
<td align="right">5.75</td>
<td align="right">1.307</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.188</td>
<td align="right">1.1</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">52</td>
<td align="right">2.80</td>
<td align="right">2.70</td>
<td align="right">0.964</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.984</td>
<td align="right">1.1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">47</td>
<td align="right">3.75</td>
<td align="right">3.05</td>
<td align="right">0.813</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.591</td>
<td align="right">1.1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0</td>
<td align="right">1.95</td>
<td align="right">5.25</td>
<td align="right">2.692</td>
<td align="left">Peds</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.443</td>
<td align="right">1.1</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">48</td>
<td align="right">2.45</td>
<td align="right">5.30</td>
<td align="right">2.163</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.072</td>
<td align="right">1.1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/metaData2DataFrame.html">metaData2DataFrame</a></span><span class="op">(</span><span class="va">pkRatiometaData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Age</th>
<th align="left">Obs</th>
<th align="left">Pred</th>
<th align="left">Ratio</th>
<th align="left">SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dimension</td>
<td align="left">Age</td>
<td align="left">Clearance</td>
<td align="left">Clearance</td>
<td align="left">Ratio</td>
<td align="left">Clearance</td>
</tr>
<tr class="even">
<td align="left">unit</td>
<td align="left">yrs</td>
<td align="left">dL/h/kg</td>
<td align="left">dL/h/kg</td>
<td align="left"></td>
<td align="left">dL/h/kg</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="predicted-vs-observed-plotpredvsobs">2. Predicted vs Observed (<code>plotPredVsObs()</code>)<a class="anchor" aria-label="anchor" href="#predicted-vs-observed-plotpredvsobs"></a>
</h2>
<div class="section level3">
<h3 id="basic-examples">2.1 Basic Examples<a class="anchor" aria-label="anchor" href="#basic-examples"></a>
</h3>
<div class="section level4">
<h4 id="default-settings">2.1.1 Default Settings<a class="anchor" aria-label="anchor" href="#default-settings"></a>
</h4>
<p>Basic example using default settings. Predicted and observed data are
mapped with <code>predicted</code> and <code>observed</code>. The
aesthetic <code>groupby</code> can be used to group observations.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/basic-examples-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with log-log scale. Points are colored by sex groups, with a unity line indicating perfect prediction. Most points cluster around the unity line indicating good model performance." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="basic-example-linear-scale">2.1.2 Basic Example: Linear Scale<a class="anchor" aria-label="anchor" href="#basic-example-linear-scale"></a>
</h4>
<p>The scale for the x and y axes is set to linear. It is not intended
to use different scales for the x and y axes. Therefore, only one
variable <code>xyScale</code> exists for both axes.</p>
<p>Predicted and observed data are mapped with <code>x</code> and
<code>y</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  xyScale <span class="op">=</span> <span class="st">"linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/basic-examples-linear-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with linear scale on both axes. Points are colored by sex groups with a unity line for reference. The linear scale allows for easier interpretation of absolute differences between predictions and observations." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="error-bars-for-observed-data">2.1.3 Error Bars for Observed Data<a class="anchor" aria-label="anchor" href="#error-bars-for-observed-data"></a>
</h4>
<p>Error bars for the observed data are plotted. In the example, this is
done by mapping <code>error_relative</code>. Error bars could also be
produced by mapping <code>error</code> to a column with an additive
error or mapping <code>xmin</code> and <code>xmax</code> explicitly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    error_relative <span class="op">=</span> <span class="va">gsd</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/basic-examples-errorbar-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with horizontal error bars representing relative error in observed data. Points are colored by sex groups, and error bars show the uncertainty in the observed measurements." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="error-bars-for-observed-and-predicted-data">2.1.4 Error Bars for Observed and Predicted Data<a class="anchor" aria-label="anchor" href="#error-bars-for-observed-and-predicted-data"></a>
</h4>
<p>To plot the prediction error, <code>ymin</code> and <code>ymax</code>
must also be mapped explicitly.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    error_relative <span class="op">=</span> <span class="va">gsd</span>,</span>
<span>    ymin <span class="op">=</span> <span class="va">Pred</span> <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span>    ymax <span class="op">=</span> <span class="va">Pred</span> <span class="op">*</span> <span class="fl">1.1</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/basic-examples-error-y-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with both horizontal error bars (for observed data uncertainty) and vertical error bars (for predicted data uncertainty). Points are colored by sex groups, demonstrating how to display uncertainty in both measurements." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="example-with-lloq">2.1.5 Example with LLOQ<a class="anchor" aria-label="anchor" href="#example-with-lloq"></a>
</h4>
<p>Below, a dataset is created where the LLOQ is set to the 0.1 quantile
of the observed data. All values below are set to LLOQ/2. By mapping
<code>lloq</code>, these data are displayed with a lighter alpha, and a
horizontal line for the LLOQ is added.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lloqData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Obs</span>, probs <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataLLOQ</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lloq <span class="op">=</span> <span class="va">lloqData</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Obs</span> <span class="op">&lt;=</span> <span class="va">lloq</span>, <span class="va">lloq</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">Obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dataLLOQ</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    lloq <span class="op">=</span> <span class="va">lloq</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/basic-examples-lloq-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with lower limit of quantification (LLOQ) handling. Values below the LLOQ are displayed with reduced transparency and marked with a horizontal LLOQ line. Data points below LLOQ are set to LLOQ/2 for visualization." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="adjust-comparison-lines">2.2 Adjust Comparison Lines<a class="anchor" aria-label="anchor" href="#adjust-comparison-lines"></a>
</h3>
<div class="section level4">
<h4 id="adjust-fold-distance">2.2.1 Adjust Fold Distance<a class="anchor" aria-label="anchor" href="#adjust-fold-distance"></a>
</h4>
<p><code><a href="../reference/plotPredVsObs.html">plotPredVsObs()</a></code> adds lines to indicate fold distances.
The lines are defined by the variable <code>comparisonLineVector</code>,
which is a named list with default values
<code>list(identity = 1, '1.5 fold' = c(1.5, 1/1.5), '2 fold' = c(2, 1/2))</code>.</p>
<p>A fold distance list can be generated by the helper function
<code>?getFoldDistanceList()</code>.</p>
<p>Below, the 1.2 and 1.5 distances are displayed:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  comparisonLineVector <span class="op">=</span> <span class="fu"><a href="../reference/getFoldDistanceList.html">getFoldDistanceList</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/examples-changeOfFold-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with custom fold distance lines. The plot includes 1.2-fold and 1.5-fold comparison lines around the unity line, helping to assess the degree of prediction accuracy. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="adjust-display-of-lines">2.2.2 Adjust Display of Lines<a class="anchor" aria-label="anchor" href="#adjust-display-of-lines"></a>
</h4>
<p>The names of the list are displayed in the legend.</p>
<p>If the list is unnamed, all lines are displayed with the same line
type, and they are not included in the legend. The line type used is
settable by the variable <code>geomComparisonLineAttributes</code>.</p>
<p>If the variable <code>comparisonLineVector</code> is NULL, no lines
will be displayed.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  comparisonLineVector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="../reference/getFoldDistanceList.html">getFoldDistanceList</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  geomComparisonLineAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/examples-adjustFoldlegend-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with unnamed fold distance lines displayed as dotted lines. The fold lines are shown without legend entries and all use the same dotted line style for a cleaner appearance. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="adding-a-regression-line">2.3 Adding a Regression Line<a class="anchor" aria-label="anchor" href="#adding-a-regression-line"></a>
</h3>
<p>To add a regression line, set the input variable
<code>addRegression</code> to <code>TRUE</code> (A). For regression
lines, the package <a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a> has a function
<code>stat_regline_equation</code> to add statistics of the regression
as labels (B). To use other functions, e.g., local polynomial
regression, use <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth</a></code> directly (C).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A</span></span>
<span><span class="va">plotObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  addRegression <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Regression Line"</span>, tag <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plotObject</span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/example-regression-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with linear regression line overlay. Points are colored by sex groups, and a fitted regression line shows the overall trend with confidence intervals. The plot demonstrates the relationship between predicted and observed values beyond the unity line." width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># B</span></span>
<span><span class="va">plotObject</span> <span class="op">+</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_regline_equation.html" class="external-link">stat_regline_equation</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">rr.label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"With RR as Label"</span>, tag <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/example-regression-withRR-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with linear regression line and R-squared statistics displayed. The plot includes the regression line with confidence intervals and an overlaid R-squared label showing the goodness of fit. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># C Local Polynomial Regression Fitting</span></span>
<span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  addRegression <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="st">"y ~ x"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Local Polynomial Regression Fitting"</span>, tag <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/example-regression-loess-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed values with local polynomial regression (LOESS) smoothing. The curved fitted line with confidence intervals captures non-linear patterns in the data that a linear regression might miss. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="add-guest-criteria-lines">2.4 Add Guest Criteria Lines<a class="anchor" aria-label="anchor" href="#add-guest-criteria-lines"></a>
</h3>
<p>To compare DDI ratios, set the variable <code>addGuestLimits</code>
to TRUE and set the variable <code>deltaGuest</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dDIdata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Study</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">dDImetaData</span>,</span>
<span>  addGuestLimits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comparisonLineVector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>identity <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  deltaGuest <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/predVsObs_Guest-1.png" class="r-plt" alt="Square scatter plot showing predicted versus observed DDI ratios with Guest criteria lines for drug-drug interaction assessment. The plot includes Guest limit lines that define acceptable ranges for DDI predictions, with different studies shown in different colors. The square format ensures equal scaling for both axes." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="use-non-square-format">2.5 Use Non-Square Format<a class="anchor" aria-label="anchor" href="#use-non-square-format"></a>
</h3>
<p>By default, <code><a href="../reference/plotPredVsObs.html">plotPredVsObs()</a></code> produces a square plot with
an aspect ratio of 1 and the same limits for the x and y axes. In the
example below, the Predicted values are set to 1/2 of the original
values. A square plot does not make sense anymore; therefore, the
variable <code>asSquarePlot</code> is set to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataNonSquare</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Pred <span class="op">=</span> <span class="va">Pred</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotPredVsObs.html">plotPredVsObs</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dataNonSquare</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  asSquarePlot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/example-nonsquare-1.png" class="r-plt" alt="Non-square scatter plot showing predicted versus observed values where predicted values have been scaled to half of observed values. The plot demonstrates how to handle cases where data ranges differ significantly between axes, using non-square format for better visualization. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="residuals-vs-covariate-plotresvscov">3. Residuals vs Covariate (<code>plotResVsCov()</code>)<a class="anchor" aria-label="anchor" href="#residuals-vs-covariate-plotresvscov"></a>
</h2>
<div class="section level3">
<h3 id="basic-examples-1">3.1 Basic Examples<a class="anchor" aria-label="anchor" href="#basic-examples-1"></a>
</h3>
<p>The function <code><a href="../reference/plotResVsCov.html">plotResVsCov()</a></code> calculates the residuals
using the aesthetics <code>observed</code> and
<code>predicted</code>.</p>
<div class="section level4">
<h4 id="default-settings-1">3.1.1 Default Settings<a class="anchor" aria-label="anchor" href="#default-settings-1"></a>
</h4>
<p>The default value for the variable <code>residualScale</code> is
“log”. Residuals will then be calculated by
<code>log(predicted) - log(observed)</code>. A horizontal comparison
line with the value 0 is displayed. The aesthetic <code>groupby</code>
can be used to group observations.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResVsCov.html">plotResVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/reVsObs-default-1.png" class="r-plt" alt="Scatter plot showing log residuals versus age with default settings. Residuals are calculated as log(predicted) - log(observed), displayed as points colored by sex groups. A horizontal reference line at zero indicates perfect prediction. Points scattered around zero suggest good model performance." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="linear-scale-for-residuals">3.1.2 Linear Scale for Residuals<a class="anchor" aria-label="anchor" href="#linear-scale-for-residuals"></a>
</h3>
<p>If the variable <code>residualScale</code> is set to “linear”,
residuals will be calculated by #<span class="math inline">$# predicted
- observed #$</span>#.</p>
<p>Below, the line type of the comparison line is set to ‘solid’.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResVsCov.html">plotResVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  residualScale <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  geomComparisonLineAttributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/resVsCov-basic-linear-1.png" class="r-plt" alt="Scatter plot showing linear residuals versus age with a solid horizontal reference line. Residuals are calculated as predicted - observed on a linear scale, with points colored by sex groups. The solid reference line at zero provides a clear visual reference for assessing prediction accuracy." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="map-residuals-directly">3.1.3 Map Residuals Directly<a class="anchor" aria-label="anchor" href="#map-residuals-directly"></a>
</h3>
<p>It is also possible to use already calculated residuals or formulas
by using the aesthetic ‘y’.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResVsCov.html">plotResVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Obs</span> <span class="op">-</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/resVsCov-basic-mappedToY-1.png" class="r-plt" alt="Scatter plot showing directly calculated residuals (observed minus predicted) versus age. Residuals are manually calculated and mapped to the y-axis, with points colored by sex groups. This demonstrates how to use pre-calculated residuals instead of automatic calculation." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="adjusting-comparison-lines">3.2 Adjusting Comparison Lines<a class="anchor" aria-label="anchor" href="#adjusting-comparison-lines"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResVsCov.html">plotResVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  comparisonLineVector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>zero <span class="op">=</span> <span class="fl">0</span>, <span class="st">"lower limit"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>, <span class="st">"upper limit"</span> <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/resVsCov-comparisonlines-1.png" class="r-plt" alt="Scatter plot showing residuals versus age with custom comparison lines. The plot includes a zero reference line and additional upper and lower limit lines at ±0.25, providing multiple reference points for evaluating prediction accuracy. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="adding-a-regression-line-1">3.3 Adding a Regression Line<a class="anchor" aria-label="anchor" href="#adding-a-regression-line-1"></a>
</h3>
<p>To add a regression line, set the input variable
<code>addRegression</code> to <code>TRUE</code>. For regression lines,
the package <a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a> has a nice function
<code>stat_regline_equation</code> to add statistics of the regression
as labels.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResVsCov.html">plotResVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  addRegression <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_regline_equation.html" class="external-link">stat_regline_equation</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">eq.label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="Scatter plot showing residuals versus age with linear regression line and equation overlay. The plot includes both a fitted regression line and the regression equation statistics, helping to identify any systematic bias in residuals with respect to age. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="ratio-plots-plotratiovscov">4. Ratio Plots (<code>plotRatioVsCov()</code>)<a class="anchor" aria-label="anchor" href="#ratio-plots-plotratiovscov"></a>
</h2>
<div class="section level3">
<h3 id="basic-examples-2">4.1 Basic Examples<a class="anchor" aria-label="anchor" href="#basic-examples-2"></a>
</h3>
<div class="section level4">
<h4 id="default-settings-2">4.1.1 Default Settings<a class="anchor" aria-label="anchor" href="#default-settings-2"></a>
</h4>
<p><code><a href="../reference/plotRatioVsCov.html">plotRatioVsCov()</a></code> is used to evaluate ratios versus a
covariate. By default, the identity and 1.5 and 2 point lines are added,
and the default for <code>yScale</code> is ‘log’. The aesthetic
<code>groupby</code> can be used to group observations.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRatioVsCov.html">plotRatioVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pkRatioData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Ratio</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/ratio-defaults-1.png" class="r-plt" alt="Log-scale scatter plot showing ratio values versus age with default comparison lines. The plot displays ratios with identity line at 1 and fold-distance lines at 1.5 and 2. Points are colored by sex groups, with the log scale helping to visualize multiplicative relationships." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="compare-residuals-as-ratio">4.1.2 Compare Residuals as Ratio<a class="anchor" aria-label="anchor" href="#compare-residuals-as-ratio"></a>
</h4>
<p>Within the function <code><a href="../reference/plotRatioVsCov.html">plotRatioVsCov()</a></code>, the variable
<code>residualScale</code> is fixed to “ratio”, and the ratio of the
residuals is calculated as $ observed / predicted $. Below, the
comparison line is set to a 1.2 fold distance.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRatioVsCov.html">plotRatioVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  comparisonLineVector <span class="op">=</span> <span class="fu"><a href="../reference/getFoldDistanceList.html">getFoldDistanceList</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/ratio-residuals-1.png" class="r-plt" alt="Scatter plot showing residual ratios (observed/predicted) versus age with 1.2-fold comparison lines. The plot demonstrates ratio-based residual analysis, where ratios above or below the comparison lines indicate systematic over- or under-prediction. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="using-ospsuite-plots-specific-aesthetics-like-mdv-and-error_relative">4.1.3 Using <code>{ospsuite.plots}</code> Specific Aesthetics like
MDV and <code>error_relative</code><a class="anchor" aria-label="anchor" href="#using-ospsuite-plots-specific-aesthetics-like-mdv-and-error_relative"></a>
</h4>
<p>If some of the data should be omitted, we can do this by mapping a
logical column to the aesthetic <code>mdv</code>. Below, we exclude data
with Age less than 20.</p>
<p>Additional error bars are displayed by mapping the column “gsd” to
the aesthetic <code>error_relative</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRatioVsCov.html">plotRatioVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pkRatioData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Ratio</span>,</span>
<span>    error_relative <span class="op">=</span> <span class="va">gsd</span>,</span>
<span>    mdv <span class="op">=</span> <span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">20</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"horizontal"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/ratio-error-1.png" class="r-plt" alt="Scatter plot showing ratio values versus age with error bars and missing data exclusion. Data points with age less than 20 are excluded (MDV flag), and relative error bars show uncertainty in the measurements. Points are colored by sex groups with horizontal legend layout." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="qualification-of-ratios">4.2 Qualification of Ratios<a class="anchor" aria-label="anchor" href="#qualification-of-ratios"></a>
</h3>
<p>If the <a href="https://r-datatable.com" class="external-link">data.table</a> package is installed and the
variable <code>comparisonLineVector</code> is a named list, the
<code>{ggplot}</code> object returned by <code>plotRatioVsCov</code> has
an additional entry <code>countsWithin</code>, which contains a
<code>data.frame</code> with the fractions within the specific ranges
given by the variable <code>comparisonLineVector</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotRatioVsCov.html">plotRatioVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pkRatioData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Age</span>,</span>
<span>    y <span class="op">=</span> <span class="va">Ratio</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plotObject</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">plotObject</span><span class="op">$</span><span class="va">countsWithin</span>, caption <span class="op">=</span> <span class="st">"Counts and fraction within ranges"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Counts and fraction within ranges</caption>
<colgroup>
<col width="12%">
<col width="14%">
<col width="18%">
<col width="20%">
<col width="15%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">group</th>
<th align="right">Points total</th>
<th align="right">1.5 fold Number</th>
<th align="right">1.5 fold Fraction</th>
<th align="right">2 fold Number</th>
<th align="right">2 fold Fraction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">all Groups</td>
<td align="right">50</td>
<td align="right">24</td>
<td align="right">0.48</td>
<td align="right">32</td>
<td align="right">0.64</td>
</tr>
<tr class="even">
<td align="left">Female</td>
<td align="right">25</td>
<td align="right">11</td>
<td align="right">0.44</td>
<td align="right">16</td>
<td align="right">0.64</td>
</tr>
<tr class="odd">
<td align="left">Male</td>
<td align="right">25</td>
<td align="right">13</td>
<td align="right">0.52</td>
<td align="right">16</td>
<td align="right">0.64</td>
</tr>
</tbody>
</table>
<p><img src="goodness-of-fit_files/figure-html/qualification-plot-1.png" class="r-plt" alt="Scatter plot showing ratio values versus age with qualification analysis. The plot generates both the visualization and a statistical summary table showing the fraction of data points within specified comparison ranges. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="add-guest-criteria-lines-1">4.3 Add Guest Criteria Lines<a class="anchor" aria-label="anchor" href="#add-guest-criteria-lines-1"></a>
</h3>
<p>To compare DDI ratios, set the variable <code>addGuestLimits</code>
to TRUE and set the variable <code>deltaGuest</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotRatioVsCov.html">plotRatioVsCov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dDIdata</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Study</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">dDImetaData</span>,</span>
<span>  addGuestLimits <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comparisonLineVector <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plotObject</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">plotObject</span><span class="op">$</span><span class="va">countsWithin</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="18%">
<col width="31%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="left">group</th>
<th align="right">Points total</th>
<th align="right">guest criteria Number</th>
<th align="right">guest criteria Fraction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">all Groups</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">Study 1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">Study 2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">Study 3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td align="left">Study 4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">Study 5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td align="left">Study 6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">Study 7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">Study 8</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">Study 9</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">Study 10</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
<p><img src="goodness-of-fit_files/figure-html/ratio-Guest-1.png" class="r-plt" alt="Scatter plot showing predicted versus observed DDI ratios with Guest criteria lines indicating acceptable ranges for drug-drug interaction assessment. Different studies are represented in different colors, and the plot effectively visualizes the prediction accuracy against the Guest criteria." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="quantile-plot-plotqq">5. Quantile Plot (<code>plotQQ()</code>)<a class="anchor" aria-label="anchor" href="#quantile-plot-plotqq"></a>
</h2>
<p><code><a href="../reference/plotQQ.html">plotQQ()</a></code> produces a Quantile-Quantile plot. If using the
aesthetics <code>predicted</code> and <code>observed</code>, residuals
will be calculated according to the variable <code>residualScale</code>.
In the example below, the default value log is used.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotQQ.html">plotQQ</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/qq-log-1.png" class="r-plt" alt="Quantile-quantile plot showing the distribution of log residuals compared to a normal distribution. Points follow the diagonal reference line if residuals are normally distributed. Deviations from the line indicate non-normal distribution patterns. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
<p>The aesthetic ‘sample’ columns with already calculated residuals or
formulas can be mapped directly.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotQQ.html">plotQQ</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  residualScale <span class="op">=</span> <span class="st">"linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/qqplot-1.png" class="r-plt" alt="Quantile-quantile plot with sample data mapped directly to observed values and linear residual scale. This demonstrates mapping pre-calculated values directly using the sample aesthetic instead of automatic residual calculation. Points are colored by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="usage-of-aesthetics-predicted-and-observed-in-other-functions">6 Usage of Aesthetics <code>predicted</code> and
<code>observed</code> in Other Functions<a class="anchor" aria-label="anchor" href="#usage-of-aesthetics-predicted-and-observed-in-other-functions"></a>
</h2>
<p>The aesthetics <code>observed</code> and <code>predicted</code> can
also be used in the functions <code><a href="../reference/plotHistogram.html">plotHistogram()</a></code> and
<code><a href="../reference/plotBoxWhisker.html">plotBoxWhisker()</a></code>. The residuals will be calculated as
defined by the variable <code>residualScale</code>.</p>
<div class="section level3">
<h3 id="residuals-as-histogram">6.1 Residuals as Histogram<a class="anchor" aria-label="anchor" href="#residuals-as-histogram"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotHistogram.html">plotHistogram</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    groupby <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  residualScale <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>  plotAsFrequency <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"normal"</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/histogram-residuals-1.png" class="r-plt" alt="Histogram showing the distribution of log residuals with normal distribution overlay curve. The frequency-based histogram includes a dashed vertical line at zero and a fitted normal distribution curve to assess whether residuals follow a normal distribution. Histograms are stratified by sex groups." width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="stratify-residuals-with-a-box-whisker-plot">6.2 Stratify Residuals with a Box-Whisker Plot<a class="anchor" aria-label="anchor" href="#stratify-residuals-with-a-box-whisker-plot"></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span></span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    predicted <span class="op">=</span> <span class="va">Pred</span>,</span>
<span>    observed <span class="op">=</span> <span class="va">Obs</span>,</span>
<span>    x <span class="op">=</span> <span class="va">Sex</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">pkRatioData</span>,</span>
<span>  metaData <span class="op">=</span> <span class="va">metaData</span>,</span>
<span>  residualScale <span class="op">=</span> <span class="st">"linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="goodness-of-fit_files/figure-html/boxwhisker-residuals-1.png" class="r-plt" alt="Box plots showing the distribution of linear residuals stratified by sex. The box plots display quartiles and whiskers for residuals calculated as observed minus predicted, allowing comparison of residual distributions between male and female groups." width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/KatrinCoboeken" class="external-link">Katrin Coboeken</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
